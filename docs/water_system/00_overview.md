# 智慧水务平台 - 架构总览

## 1. 核心设计哲学

本平台采用基于**智能体（Agent-Based）**的分布式、事件驱动架构。与传统的中心化、请求-响应式系统不同，本系统的核心理念是将复杂的水力系统分解为一系列独立的、自治的、可互相通信的智能体。

这种设计的优势在于：
*   **模块化与解耦**: 每个智能体（如一个水泵、一段河道、一个控制策略）都封装了自己的状态和行为，独立于其他智能体。
*   **可扩展性**: 向系统中添加新的设备或新的功能，通常只需要创建新的智能体，而无需修改系统的核心逻辑。
*   **灵活性**: 可以方便地构建从简单的单体仿真到复杂的多层级、分布式控制系统的各种应用场景。

## 2. 关键架构组件

### 2.1 智能体 (Agent)

智能体是系统中最基本的行为单元。`core_lib` 中的所有“活动”部件，无论是物理世界的模拟（如一个`Pipe`对象），还是决策逻辑（如一个`PIDController`），都被封装为智能体。所有智能体都遵循一个共同的 `Agent` 接口。

### 2.2 消息总线 (Message Bus)

智能体之间不直接调用彼此的方法，而是通过一个中央的**消息总线** (`core_lib.central_coordination.collaboration.message_bus`) 进行通信。

*   **发布 (Publish)**: 一个智能体可以将一条消息（例如其当前的状态）发布到一个特定的“主题(Topic)”上。
*   **订阅 (Subscribe)**: 其他智能体可以订阅它们感兴趣的主题，当有新消息发布到该主题时，它们会自动收到通知并执行相应的处理逻辑。

这种发布/订阅模式是实现智能体之间松耦合通信的关键。

### 2.3 仿真测试平台 (Simulation Harness)

`core_lib.core_engine.testing.simulation_harness` 是整个系统的“驱动引擎”。它的职责是：
1.  根据配置文件，实例化所有的智能体和物理对象。
2.  管理一个主时钟，在每个时间步 (`time step`) 调用每个智能体的 `run()` 方法。
3.  驱动仿真从开始时间运行到结束时间。

## 3. 文档结构

本系列文档将围绕 `core_lib` 代码库的实际结构，逐一介绍以下核心功能模块的实现细节和设计思想：

1.  **核心概念**: 支撑整个系统的基础架构（仿真平台、消息总线）。
2.  **物理模型**: 系统中各类水利设施的数学模型。
3.  **核心智能体**: 实现感知、决策、控制等功能的智能体。
4.  **场景定义与执行**: 如何通过配置文件来运行一个完整的仿真任务。
