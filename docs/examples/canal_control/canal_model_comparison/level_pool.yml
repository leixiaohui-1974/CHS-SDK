simulation_duration: 7200  # seconds
time_step: 10  # seconds

components:
  - name: upstream_reservoir
    class: Reservoir
    initial_state:
      water_level: 10.0
      outflow: 0.0
    parameters:
      storage_capacity: 1000000.0

  - name: gate_1
    class: Gate
    initial_state:
      opening: 0.5
      outflow: 0.0
    parameters:
      discharge_coefficient: 0.8
      width: 5.0
      height: 2.0

  - name: canal_1
    class: LevelPoolCanal
    initial_state:
      volume: 5000.0
      water_level: 5.0
      outflow: 0.0
    parameters:
      length: 1000.0
      bottom_width: 10.0
      slope: 0.001
      manning_n: 0.03

  - name: downstream_reservoir
    class: Reservoir
    initial_state:
      water_level: 2.0
      outflow: 0.0
    parameters:
      storage_capacity: 500000.0

topology:
  - from: upstream_reservoir
    to: gate_1
  - from: gate_1
    to: canal_1
  - from: canal_1
    to: downstream_reservoir

agents:
  - name: gate_controller
    class: LocalControlAgent
    parameters:
      pid:
        Kp: 0.5
        Ki: 0.05
        Kd: 0.1
        setpoint: 5.0 # Target water level in canal_1
        output_range: [0.0, 1.0]
      observation_topic: "state.canal_1"
      action_topic: "control.gate_1"
